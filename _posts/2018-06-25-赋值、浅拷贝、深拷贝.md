--- 
layout: post
title: python学习之多种拷贝之间的区别
subtitle: 赋值、浅拷贝、深拷贝
date: 2018-06-25
author: YangSijie
header-img: img/post-bg-alibaba.jpg
catalog: true
tags:
    - python
---

# 赋值、浅拷贝、深拷贝

首先，区分三个词的意思：

- 赋值: 只是复制了新对象的引用，==不会开辟新的内存空间==。 类似于C语言中的指针

- 浅拷贝: 创建新对象，其内容是原对象的引用。 

  浅拷贝有三种形式：切片操作，工厂函数，copy模块中的copy函数。 

  如： lst = [1,2,3,[4,5]]

  切片操作：lst1 = lst[:] 或者 lst1 = [each for each in lst]

  工厂函数：lst1 = list(lst)

  copy函数：lst1 = copy.copy(lst) 

  > 浅拷贝之所以称为浅拷贝，是它仅仅只拷贝了一层，在lst中有一个嵌套的list[4,5]，如果我们修改了它，情况就不一样了。 

- 深拷贝：只有一种形式，copy模块中的deepcopy函数。（完完全全另外开辟了一个新的内存空间）

  和浅拷贝对应，深拷贝拷贝了对象的所有元素，包括多层嵌套的元素。

  深拷贝出来的对象是一个全新的对象，不再与原来的对象有任何关联。

看以下例子：

```python
>>> import copy
>>> a = [1,2,3,4,['a','b']] #定义一个列表a
>>> b = a #赋值
>>> c = copy.copy(a) #浅拷贝
>>> d = copy.deepcopy(a) #深拷贝

>>> a.append(5)
>>> print(a)
[1, 2, 3, 4, ['a', 'b'], 5] #a添加一个元素5
>>> print(b) 
[1, 2, 3, 4, ['a', 'b'], 5] #b跟着添加一个元素5 
>>> print(c)
[1, 2, 3, 4, ['a', 'b']] #c保持不变
>>> print(d)
[1, 2, 3, 4, ['a', 'b']] #d保持不变

>>> a[4].append('c') 
>>> print(a)
[1, 2, 3, 4, ['a', 'b', 'c'], 5] #a中的list(即a[4])添加一个元素c
>>> print(b)
[1, 2, 3, 4, ['a', 'b', 'c'], 5] #b跟着添加一个元素c
>>> print(c)
[1, 2, 3, 4, ['a', 'b', 'c']] #c跟着添加一个元素c
>>> print(d)
[1, 2, 3, 4, ['a', 'b']] #d保持不变
```

### 总结：

:dolphin: 外层添加元素时， `浅拷贝c`不会随原列表a变化而变化；==内层list添加元素==时，浅拷贝c才会变化。

:dolphin: 无论原列表a如何变化，`深拷贝d`都保持不变。

:dolphin: `赋值对象`随着原列表一起变化